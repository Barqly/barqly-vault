#!/bin/bash

# Barqly Vault Pre-commit Hook
# This hook reminds about local validation before commits

set -e

echo "ğŸ” Barqly Vault Pre-commit Validation"
echo "======================================"

# Check if we're in the src-tauri directory or if it exists
if [ -d "src-tauri" ]; then
    echo "ğŸ“¦ Rust project detected."
    echo ""
    echo "ğŸ’¡ REMINDER: Consider running local validation before pushing:"
    echo "   cd src-tauri && cargo fmt && cargo clippy && cargo test"
    echo ""
    echo "â±ï¸  This saves time by preventing CI failures (4-5 min cycles)."
    echo ""
else
    echo "â„¹ï¸  No Rust project found, skipping Rust validation reminder"
fi

# Check for any staged files that might need validation
echo "ğŸ“‹ Checking staged files..."

# Check for any .ts/.tsx files (frontend validation)
if git diff --cached --name-only | grep -E '\.(ts|tsx)$' > /dev/null; then
    echo "ğŸŒ TypeScript files detected"
    if [ -d "src-ui" ]; then
        echo "ğŸ’¡ Consider running 'npm run lint' and 'npm run test' in src-ui/"
    fi
fi

echo ""
echo "ğŸ“ Proceeding with commit..."
echo ""

exit 0 